<!doctype html>
<html lang="en"><head>
<title>Hexo</title>
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta name="description" content="buu [GWCTF 2019]xxor![屏幕截图 2024-04-24 192519](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192519.png) main函数之前有运行其他函数，但没什么影响 ![屏幕截图 2024-04-24 192612](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192612.png) a2是一个指针，v6每">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2024/05/02/5.1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="buu [GWCTF 2019]xxor![屏幕截图 2024-04-24 192519](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192519.png) main函数之前有运行其他函数，但没什么影响 ![屏幕截图 2024-04-24 192612](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192612.png) a2是一个指针，v6每">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-02T01:19:54.140Z">
<meta property="article:modified_time" content="2024-05-02T01:20:41.797Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1720491933012">

<link rel="stylesheet" href="/css/style.css?v=1720491933012">




    
        <link rel="stylesheet" href="/custom.css?v=1720491933012">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1720491933012"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 7.3.0"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(https://i.dawnlab.me/b5a7e61560facdd5b8aa9683fce147d7.png)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="John Doe"><img src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/avatar.png" alt="John Doe"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="John Doe">
            <img src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/avatar.png" alt="John Doe" alt="John Doe">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>2</div>
        <div><span>Tags</span>0</div>
        <div><span>Categories</span>0</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" target="_blank" rel="noopener" href="https://nexmoe.com/donate.html" title="给我赞助">
            <i class="mdui-list-item-icon nexmoefont icon-coffee"></i>
            <div class="mdui-list-item-content">
                给我赞助
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" target="_blank" rel="noopener" href="https://i.nexmoe.com/" title="关于博主">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博主
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="Search"></label>
            </form>
         
    </div>
</div>




    
        
        <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="https://jq.qq.com/?_wv=1027&k=5CfKHun"
			target="_blank"
			mdui-tooltip="{content: 'QQ群'}"
			style="
				color: rgb(249, 174, 8);
				background-color: rgba(249, 174, 8, .1);
			"
		>
			<i
				class="nexmoefont icon-QQ"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://space.bilibili.com/20238211"
			target="_blank"
			mdui-tooltip="{content: '哔哩哔哩'}"
			style="
				color: rgb(231, 106, 141);
				background-color: rgba(231, 106, 141, .1);
			"
		>
			<i
				class="nexmoefont icon-bilibili"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://github.com/nexmoe/"
			target="_blank"
			mdui-tooltip="{content: 'GitHub'}"
			style="
				color: rgb(25, 23, 23);
				background-color: rgba(25, 23, 23, .1);
			"
		>
			<i
				class="nexmoefont icon-github"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://www.zhihu.com/people/nexmoe"
			target="_blank"
			mdui-tooltip="{content: '知乎'}"
			style="
				color: rgb(30, 136, 229);
				background-color: rgba(30, 136, 229, .1);
			"
		>
			<i
				class="nexmoefont icon-zhihu"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://twitter.com/nexmoe"
			target="_blank"
			mdui-tooltip="{content: 'Twitter'}"
			style="
				color: rgb(59, 151, 239);
				background-color: rgba(59, 151, 239, .1);
			"
		>
			<i
				class="nexmoefont icon-twitter"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://nexmoe.com/atom.xml"
			target="_blank"
			mdui-tooltip="{content: 'RSS'}"
			style="
				color: rgb(247, 132, 34);
				background-color: rgba(247, 132, 34, .1);
			"
		>
			<i
				class="nexmoefont icon-rss"
			></i> </a
		>
	</div>
</div>

    
        
        

    
        
        
    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Archive</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Recent Posts</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2024/07/07/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2024/05/02/5.1/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-link">
		<ul>
        
            <li>
                <a href="https://nexmoe.com/" target="_blank" >
                    <img src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/avatar.png" alt="折影轻梦"></img>
                    <p>折影轻梦</p>
                </a>
            </li>
        
		</ul>
    </div>
</div>
<style>
.nexmoe-widget-wrap .nexmoe-link ul li a {
    text-align : center;
}
.nexmoe-widget-wrap .nexmoe-link ul li a img {
    max-width : 100%;
}
.nexmoe-widget-wrap .nexmoe-link ul li a p {
    margin: 10px 0;
}
</style>

    
   
    <div class="nexmoe-copyright">
        &copy; 2024 John Doe
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href="https://beian.miit.gov.cn/">鄂ICP备2020018486号</a>
<br><a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral">
<img src="https://i.dawnlab.me/c0268c1e6cfd0863d6ba35be1575941a.png" width="150px"></a>

    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="https://i.dawnlab.me/b5a7e61560facdd5b8aa9683fce147d7.png" alt="" loading="lazy">
            <h1></h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2024年05月02日</a>
        
        
    </div>
    
    
    
    
    
</div>

    <p>buu</p>
<h2 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h2><p>![屏幕截图 2024-04-24 192519](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192519.png)</p>
<p>main函数之前有运行其他函数，但没什么影响</p>
<p>![屏幕截图 2024-04-24 192612](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192612.png)</p>
<p>a2是一个指针，v6每次给它一个地址，然后由a2接收输入的值，总共输入6个值每个值32占位空间，v6的值最后给了v7作为判断的一段</p>
<p>![屏幕截图 2024-04-24 192941](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 192941.png)</p>
<p>tea加密，密钥是[2,2,3,4]</p>
<p>![屏幕截图 2024-04-24 193402](.&#x2F;assets&#x2F;屏幕截图 2024-04-24 193402.png)</p>
<p>最后的判断程序，a1数组的值应该即为程序加密过的密文，这里为了求解a1，采用python下的一个模块z3约束器</p>
<h3 id="z3"><a href="#z3" class="headerlink" title="z3"></a>z3</h3><p>用法<br>1.声明变量</p>
<p>z3中有3中类型的变量，分别是整型(Int),实型(Real)和向量(BitVec)</p>
<p>Int-整数型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">a = Int(&#x27;a&#x27;)#声明单个整型变量</span><br><span class="line">a,b = Ints(&#x27;a b&#x27;)#声明多个整型变量</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Real-实数型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">a = Real(&#x27;a&#x27;)#声明单个实型变量</span><br><span class="line">a,b = Reals(&#x27;a b&#x27;)#声明多个实型变量</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>计算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">a,b = Ints(&#x27;a b&#x27;)</span><br><span class="line">solve(a&gt;3,b&lt;8,2*a+b==16)</span><br><span class="line">#结果 [a = 5, b = 6</span><br></pre></td></tr></table></figure>

<p>在解决问题是很多情况下是有多个约束条件的。这个时候可以先生成一个求解器对象(Solver())，然后就可以方便的向其中添加更多的约束条件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">a,b = Ints(&#x27;a b&#x27;)</span><br><span class="line">solver = Solver()#创建一个求解器对象</span><br><span class="line">solver.add(a+b==10)#用add方法添加约束条件</span><br><span class="line">solver.add(a-b==6)</span><br><span class="line">if solver.check() == sat: #check()方法用来判断是否有解，sat(satisify)表示满足有解</span><br><span class="line">    ans = solver.model() #model()方法得到解</span><br><span class="line">    print(ans)</span><br><span class="line">    #也可以用变量名作为下标得到解</span><br><span class="line">    print(ans[a])</span><br><span class="line">else:</span><br><span class="line">    print(&quot;no ans!&quot;)</span><br></pre></td></tr></table></figure>


<p>更多用法参考官方文档：</p>
<p><a target="_blank" rel="noopener" href="https://rise4fun.com/z3/tutorialcontent/guide">https://rise4fun.com/z3/tutorialcontent/guide</a></p>
<p>回归题目z3脚本如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">a1,a2,a3,a4,a5,a6=Ints(&#x27;a1 a2 a3 a4 a5 a6&#x27;)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(a3-a4==2225223423)</span><br><span class="line">s.add(a4+a5==4201428739)</span><br><span class="line">s.add(a3-a5==1121399208)</span><br><span class="line">s.add(a1==-548868226)</span><br><span class="line">s.add(a6==-2064448480)</span><br><span class="line">s.add(a2==550153460)</span><br><span class="line">if(s.check()==sat):</span><br><span class="line">    print(s.model())</span><br><span class="line">else:</span><br><span class="line">    print(&quot;false&quot;)</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[6]=[-548868226,550153460,3774025685,1548802262,2652626477,-2064448480]</span><br></pre></td></tr></table></figure>

<p>随后进行tea加密的逆运算即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    __int64 a[6] = &#123; 3746099070, 550153460, 3774025685, 1548802262, 2652626477, 2230518816 &#125;;</span><br><span class="line">    int a2[4] = &#123; 2,2,3,4 &#125;;</span><br><span class="line">    int v3, v4;</span><br><span class="line">    int v5;</span><br><span class="line">    for (int j = 0; j &lt;= 4; j += 2) &#123;</span><br><span class="line">        v3 = a[j];</span><br><span class="line">        v4 = a[j + 1];</span><br><span class="line">        v5 = 1166789954*0x40;</span><br><span class="line">        for (int i = 0; i &lt;= 0x3F; ++i) &#123;</span><br><span class="line">            v4 -= (v3 + v5 + 20) ^ ((v3 &lt;&lt; 6) + a2[2]) ^ ((v3 &gt;&gt; 9) + a2[3]) ^ 0x10;</span><br><span class="line">            v3 -= (v4 + v5 + 11) ^ ((v4 &lt;&lt; 6) + *a2) ^ ((v4 &gt;&gt; 9) + a2[1]) ^ 0x20;</span><br><span class="line">            v5 -= 1166789954;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = v3;</span><br><span class="line">        a[j + 1] = v4;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 0; i &lt; 6; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; *((char*)&amp;a[i] + 2) &lt;&lt; *((char*)&amp;a[i] + 1) &lt;&lt;  * ((char*)&amp;a[i]);//整形数据转换字符串类型输出，注意计算机小端排序，因此这里采用对一个整型数据作逆序</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    system(&quot;PAUSE&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag{re_is_great!}</p>
<h2 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h2><p>查壳,elf，拉入linux，切换到远程调试，</p>
<p>ida打开，查看源码</p>
<p>![屏幕截图 2024-04-17 192832](.&#x2F;assets&#x2F;屏幕截图 2024-04-17 192832.png)</p>
<p>明显的base64加密，但直接拉入base64解密工具后得到错误结果，分析原因，可能有二</p>
<p>一是明文有过改动</p>
<p>二是子码表被更改</p>
<p>但main函数中不存在上述两个过程，因此查main的交叉引用，查看是否有函数先于main函数运行，</p>
<p>![屏幕截图 2024-04-17 193241](.&#x2F;assets&#x2F;屏幕截图 2024-04-17 193241.png)</p>
<p>找到main函数的主调函数，但是仍找到需要的过程转换思路，直接从被修改的值下手</p>
<p>查base64子码表的交叉引用，发现一个很显眼的函数![屏幕截图 2024-04-17 193408](.&#x2F;assets&#x2F;屏幕截图 2024-04-17 193408.png)</p>
<p>果然在这函数中字码表被修改</p>
<p>因此我们选择运行，在进入main函数后再去找已经修改过的子码表</p>
<p>![屏幕截图 2024-04-17 193704](.&#x2F;assets&#x2F;屏幕截图 2024-04-17 193704.png)</p>
<p>找到新的子码表后，在使用相应工具即可</p>
<h2 id="特殊的base64"><a href="#特殊的base64" class="headerlink" title="特殊的base64"></a>特殊的base64</h2><p>用Exeinfo PE 查壳</p>
<p>发现未加壳。</p>
<p>![屏幕截图 2024-05-02 083621](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 083621.png)</p>
<p>运行程序输入任意字符后程序直接退出，推断可能是判断输入的Base64是否和某特定值相同，不相同程序就退出。</p>
<p>使用IDA打开该程序文件，找到main函数，使用F5快捷键反编译生成伪代码。</p>
<p>![屏幕截图 2024-05-02 083818](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 083818.png)</p>
<p>发现第14行的”rightFlag“：mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI&#x3D;&#x3D;，像是经Base64加密后的字符串。</p>
<p> 尝试base64解码，得到结果：</p>
<p>这并非可识别的flag。![屏幕截图 2024-05-02 083859](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 083859.png)</p>
<p>重新查看main函数的行为，发现函数base64Encode对result的数据进行了加密。<br>进入base64Encode函数，发现自定义加密字典：<br>AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321&#x2F;+</p>
<p>为换表base64加密</p>
<p>使用该字典对前面的字符串解码，得到：</p>
<p>![屏幕截图 2024-05-02 084028](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 084028.png)</p>
<h2 id="Universe-final-answer"><a href="#Universe-final-answer" class="headerlink" title="Universe_final_answer"></a>Universe_final_answer</h2><p>ida f5找到主函数，发现关键函数sub_860()：</p>
<p>![屏幕截图 2024-05-02 084913](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 084913.png)</p>
<p>其实本身逻辑是比较简单的，问题就在于怎么运算：</p>
<p>所以再次用到z3约束器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line"> </span><br><span class="line">#s = Solver()</span><br><span class="line">v1 = Int(&#x27;v1&#x27;)</span><br><span class="line">v2 = Int(&#x27;v2&#x27;)</span><br><span class="line">v3 = Int(&#x27;v3&#x27;)</span><br><span class="line">v4 = Int(&#x27;v4&#x27;)</span><br><span class="line">v5 = Int(&#x27;v5&#x27;)</span><br><span class="line">v6 = Int(&#x27;v6&#x27;)</span><br><span class="line">v7 = Int(&#x27;v7&#x27;)</span><br><span class="line">v8 = Int(&#x27;v8&#x27;)</span><br><span class="line">v9 = Int(&#x27;v9&#x27;)</span><br><span class="line">v11 = Int(&#x27;v11&#x27;)</span><br><span class="line"> </span><br><span class="line">s.add(-85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613)</span><br><span class="line">s.add(</span><br><span class="line">    30 * v11 + -70 * v9 + -122 * v6 + -81 * v7 + -66 * v5 + -115 * v4 + -41 * v3 + -86 * v1 - 15 * v2 - 30 * v8 == -54400)</span><br><span class="line">s.add(-103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (</span><br><span class="line">            v6 * 64) - 120 * v9 == -10283)</span><br><span class="line">s.add(71 * v6 + (v7 * 128) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 == 22855)</span><br><span class="line">s.add(5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 == -2944)</span><br><span class="line">s.add(-54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 == -2222)</span><br><span class="line">s.add(-83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 == -13258)</span><br><span class="line">s.add(81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 == -1559)</span><br><span class="line">s.add(101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 == 6308)</span><br><span class="line">s.add(99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 == -1697)</span><br><span class="line"> </span><br><span class="line">if s.check() == sat:</span><br><span class="line">    result = s.model()</span><br><span class="line"> </span><br><span class="line">print(result)</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>按照相应的顺序转成字符串（根据ida内函数逻辑可以知道，v2和v1互换，v7和v6互换）</p>
<p>得到内容：F0uRTy_7w@，将其输入到输入到程序中，即可get flag！</p>
<p>flag{F0uRTy_7w@_42}</p>
<h2 id="MFC"><a href="#MFC" class="headerlink" title="MFC"></a>MFC</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>在VS一开始安装的时候,没有勾选MFC模块的话,是无法快速构成MFC应用的.<br>1.观察VS2019中有无MFC模块<br>若没有下载安装MFC模块<br>2.创建一个基于对话框的MFC应用程序<br>MFC是一个框架，新建一个MFC的工程，开发环境会自动产生许多文件，即使不添加一行代码，也可以编译运行，生成一个默认的有界面的软件。![屏幕截图 2024-05-02 085958](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 085958.png)</p>
<p>3.MFC框架结构<br>了解生成框架代码，能更好的在MFC在框架上开发软件。</p>
<p>课程介绍</p>
<p>![屏幕截图 2024-05-02 085929](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 085929.png)</p>
<p>![屏幕截图 2024-05-02 085940](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 085940.png)</p>
<p>MFC提供三种模板 单文档 多文档 对话框</p>
<p>![屏幕截图 2024-05-02 090037](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 090037.png)</p>
<p>![屏幕截图 2024-05-02 090023](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 090023.png)</p>
<p>模板中类继承层次：</p>
<p>单文档类的继承层次</p>
<p>![屏幕截图 2024-04-29 210704](.&#x2F;assets&#x2F;屏幕截图 2024-04-29 210704-1714612163409-24.png)</p>
<p>不同类的作用：</p>
<p>父类可以实现的功能 子类也可以实现</p>
<p>![屏幕截图 2024-04-29 210708](.&#x2F;assets&#x2F;屏幕截图 2024-04-29 210704-1714612163409-25.png)</p>
<p>在官网中可以看到层次结构图</p>
<p>![屏幕截图 2024-04-29 210711](.&#x2F;assets&#x2F;屏幕截图 2024-04-29 210704-1714612163409-26.png)</p>
<p> F10找到winmain</p>
<p>![屏幕截图 2024-04-29 210716](.&#x2F;assets&#x2F;屏幕截图 2024-04-29 210704-1714612163409-27.png)</p>
<p>选中SingleDoc，选择项目的属性</p>
<p>![屏幕截图 2024-04-29 210720](.&#x2F;assets&#x2F;屏幕截图 2024-04-29 210704-1714612163409-28.png)</p>
<p>选择高级，MFC的使用，在静态库中使用MFC</p>
<h3 id="以下了解与网络"><a href="#以下了解与网络" class="headerlink" title="以下了解与网络"></a>以下了解与网络</h3><p> <strong>应用程序类</strong><br>MFC定义了一个应用程序基类CWinApp，所有基于MFC的应用程序都会继承这个类。DemoCV项目也不例外，此时的应用程序类是CDemoCVOneApp。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">// DemoCV.cpp: 定义应用程序的类行为。</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#include &quot;pch.h&quot;</span><br><span class="line">#include &quot;framework.h&quot;</span><br><span class="line">#include &quot;DemoCV.h&quot;</span><br><span class="line">#include &quot;DemoCVDlg.h&quot;</span><br><span class="line"></span><br><span class="line">#ifdef _DEBUG</span><br><span class="line">#define new DEBUG_NEW</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// CDemoCVApp</span><br><span class="line"></span><br><span class="line">BEGIN_MESSAGE_MAP(CDemoCVApp, CWinApp)</span><br><span class="line">	ON_COMMAND(ID_HELP, &amp;CWinApp::OnHelp)</span><br><span class="line">END_MESSAGE_MAP()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// CDemoCVApp 构造</span><br><span class="line"></span><br><span class="line">CDemoCVApp::CDemoCVApp()</span><br><span class="line">&#123;</span><br><span class="line">	// 支持重新启动管理器</span><br><span class="line">	m_dwRestartManagerSupportFlags = AFX_RESTART_MANAGER_SUPPORT_RESTART;</span><br><span class="line"></span><br><span class="line">	// TODO: 在此处添加构造代码，</span><br><span class="line">	// 将所有重要的初始化放置在 InitInstance 中</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 唯一的 CDemoCVApp 对象</span><br><span class="line"></span><br><span class="line">CDemoCVApp theApp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// CDemoCVApp 初始化</span><br><span class="line"></span><br><span class="line">BOOL CDemoCVApp::InitInstance()</span><br><span class="line">&#123;</span><br><span class="line">	// 如果一个运行在 Windows XP 上的应用程序清单指定要</span><br><span class="line">	// 使用 ComCtl32.dll 版本 6 或更高版本来启用可视化方式，</span><br><span class="line">	//则需要 InitCommonControlsEx()。  否则，将无法创建窗口。</span><br><span class="line">	INITCOMMONCONTROLSEX InitCtrls;</span><br><span class="line">	InitCtrls.dwSize = sizeof(InitCtrls);</span><br><span class="line">	// 将它设置为包括所有要在应用程序中使用的</span><br><span class="line">	// 公共控件类。</span><br><span class="line">	InitCtrls.dwICC = ICC_WIN95_CLASSES;</span><br><span class="line">	InitCommonControlsEx(&amp;InitCtrls);</span><br><span class="line"></span><br><span class="line">	CWinApp::InitInstance();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	AfxEnableControlContainer();</span><br><span class="line"></span><br><span class="line">	// 创建 shell 管理器，以防对话框包含</span><br><span class="line">	// 任何 shell 树视图控件或 shell 列表视图控件。</span><br><span class="line">	CShellManager *pShellManager = new CShellManager;</span><br><span class="line"></span><br><span class="line">	// 激活“Windows Native”视觉管理器，以便在 MFC 控件中启用主题</span><br><span class="line">	CMFCVisualManager::SetDefaultManager(RUNTIME_CLASS(CMFCVisualManagerWindows));</span><br><span class="line"></span><br><span class="line">	// 标准初始化</span><br><span class="line">	// 如果未使用这些功能并希望减小</span><br><span class="line">	// 最终可执行文件的大小，则应移除下列</span><br><span class="line">	// 不需要的特定初始化例程</span><br><span class="line">	// 更改用于存储设置的注册表项</span><br><span class="line">	// TODO: 应适当修改该字符串，</span><br><span class="line">	// 例如修改为公司或组织名</span><br><span class="line">	SetRegistryKey(_T(&quot;应用程序向导生成的本地应用程序&quot;));</span><br><span class="line"></span><br><span class="line">	CDemoCVDlg dlg;</span><br><span class="line">	m_pMainWnd = &amp;dlg;</span><br><span class="line">	INT_PTR nResponse = dlg.DoModal();</span><br><span class="line">	if (nResponse == IDOK)</span><br><span class="line">	&#123;</span><br><span class="line">		// TODO: 在此放置处理何时用</span><br><span class="line">		//  “确定”来关闭对话框的代码</span><br><span class="line">	&#125;</span><br><span class="line">	else if (nResponse == IDCANCEL)</span><br><span class="line">	&#123;</span><br><span class="line">		// TODO: 在此放置处理何时用</span><br><span class="line">		//  “取消”来关闭对话框的代码</span><br><span class="line">	&#125;</span><br><span class="line">	else if (nResponse == -1)</span><br><span class="line">	&#123;</span><br><span class="line">		TRACE(traceAppMsg, 0, &quot;警告: 对话框创建失败，应用程序将意外终止。\n&quot;);</span><br><span class="line">		TRACE(traceAppMsg, 0, &quot;警告: 如果您在对话框上使用 MFC 控件，则无法 #define _AFX_NO_MFC_CONTROLS_IN_DIALOGS。\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 删除上面创建的 shell 管理器。</span><br><span class="line">	if (pShellManager != nullptr)</span><br><span class="line">	&#123;</span><br><span class="line">		delete pShellManager;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">#if !defined(_AFXDLL) &amp;&amp; !defined(_AFX_NO_MFC_CONTROLS_IN_DIALOGS)</span><br><span class="line">	ControlBarCleanUp();</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">	// 由于对话框已关闭，所以将返回 FALSE 以便退出应用程序，</span><br><span class="line">	//  而不是启动应用程序的消息泵。</span><br><span class="line">	return FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>对话框类</strong><br>MFC主对话框类（主对话框是指与项目名称一致的那个类对应的对话框，下同）CDemoCVDlg继承CDialogEx类，CDialogEx又继承CDialog类，这个可以通过类转到定义查看，对话框类负责与用户交互，处理用户消息，接受用户输入。类的定义如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">// DemoCVDlg.cpp: 实现文件</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#include &quot;pch.h&quot;</span><br><span class="line">#include &quot;framework.h&quot;</span><br><span class="line">#include &quot;DemoCV.h&quot;</span><br><span class="line">#include &quot;DemoCVDlg.h&quot;</span><br><span class="line">#include &quot;afxdialogex.h&quot;</span><br><span class="line"></span><br><span class="line">#ifdef _DEBUG</span><br><span class="line">#define new DEBUG_NEW</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 用于应用程序“关于”菜单项的 CAboutDlg 对话框</span><br><span class="line"></span><br><span class="line">class CAboutDlg : public CDialogEx</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">	CAboutDlg();</span><br><span class="line"></span><br><span class="line">// 对话框数据</span><br><span class="line">#ifdef AFX_DESIGN_TIME</span><br><span class="line">	enum &#123; IDD = IDD_ABOUTBOX &#125;;</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">	protected:</span><br><span class="line">	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV 支持</span><br><span class="line"></span><br><span class="line">// 实现</span><br><span class="line">protected:</span><br><span class="line">	DECLARE_MESSAGE_MAP()</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">CAboutDlg::CAboutDlg() : CDialogEx(IDD_ABOUTBOX)</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void CAboutDlg::DoDataExchange(CDataExchange* pDX)</span><br><span class="line">&#123;</span><br><span class="line">	CDialogEx::DoDataExchange(pDX);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BEGIN_MESSAGE_MAP(CAboutDlg, CDialogEx)</span><br><span class="line">END_MESSAGE_MAP()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// CDemoCVDlg 对话框</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CDemoCVDlg::CDemoCVDlg(CWnd* pParent /*=nullptr*/)</span><br><span class="line">	: CDialogEx(IDD_DEMOCV_DIALOG, pParent)</span><br><span class="line">&#123;</span><br><span class="line">	m_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void CDemoCVDlg::DoDataExchange(CDataExchange* pDX)</span><br><span class="line">&#123;</span><br><span class="line">	CDialogEx::DoDataExchange(pDX);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BEGIN_MESSAGE_MAP(CDemoCVDlg, CDialogEx)</span><br><span class="line">	ON_WM_SYSCOMMAND()</span><br><span class="line">	ON_WM_PAINT()</span><br><span class="line">	ON_WM_QUERYDRAGICON()</span><br><span class="line">END_MESSAGE_MAP()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// CDemoCVDlg 消息处理程序</span><br><span class="line"></span><br><span class="line">BOOL CDemoCVDlg::OnInitDialog()</span><br><span class="line">&#123;</span><br><span class="line">	CDialogEx::OnInitDialog();</span><br><span class="line"></span><br><span class="line">	// 将“关于...”菜单项添加到系统菜单中。</span><br><span class="line"></span><br><span class="line">	// IDM_ABOUTBOX 必须在系统命令范围内。</span><br><span class="line">	ASSERT((IDM_ABOUTBOX &amp; 0xFFF0) == IDM_ABOUTBOX);</span><br><span class="line">	ASSERT(IDM_ABOUTBOX &lt; 0xF000);</span><br><span class="line"></span><br><span class="line">	CMenu* pSysMenu = GetSystemMenu(FALSE);</span><br><span class="line">	if (pSysMenu != nullptr)</span><br><span class="line">	&#123;</span><br><span class="line">		BOOL bNameValid;</span><br><span class="line">		CString strAboutMenu;</span><br><span class="line">		bNameValid = strAboutMenu.LoadString(IDS_ABOUTBOX);</span><br><span class="line">		ASSERT(bNameValid);</span><br><span class="line">		if (!strAboutMenu.IsEmpty())</span><br><span class="line">		&#123;</span><br><span class="line">			pSysMenu-&gt;AppendMenu(MF_SEPARATOR);</span><br><span class="line">			pSysMenu-&gt;AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// 设置此对话框的图标。  当应用程序主窗口不是对话框时，框架将自动</span><br><span class="line">	//  执行此操作</span><br><span class="line">	SetIcon(m_hIcon, TRUE);			// 设置大图标</span><br><span class="line">	SetIcon(m_hIcon, FALSE);		// 设置小图标</span><br><span class="line"></span><br><span class="line">	// TODO: 在此添加额外的初始化代码</span><br><span class="line"></span><br><span class="line">	return TRUE;  // 除非将焦点设置到控件，否则返回 TRUE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void CDemoCVDlg::OnSysCommand(UINT nID, LPARAM lParam)</span><br><span class="line">&#123;</span><br><span class="line">	if ((nID &amp; 0xFFF0) == IDM_ABOUTBOX)</span><br><span class="line">	&#123;</span><br><span class="line">		CAboutDlg dlgAbout;</span><br><span class="line">		dlgAbout.DoModal();</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		CDialogEx::OnSysCommand(nID, lParam);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void CDemoCVDlg::OnPaint()</span><br><span class="line">&#123;</span><br><span class="line">	if (IsIconic())</span><br><span class="line">	&#123;</span><br><span class="line">		CPaintDC dc(this); // 用于绘制的设备上下文</span><br><span class="line"></span><br><span class="line">		SendMessage(WM_ICONERASEBKGND, reinterpret_cast&lt;WPARAM&gt;(dc.GetSafeHdc()), 0)</span><br><span class="line">		int cxIcon = GetSystemMetrics(SM_CXICON);</span><br><span class="line">		int cyIcon = GetSystemMetrics(SM_CYICON);</span><br><span class="line">		CRect rect;</span><br><span class="line">		GetClientRect(&amp;rect);</span><br><span class="line">		int x = (rect.Width() - cxIcon + 1) / 2;</span><br><span class="line">		int y = (rect.Height() - cyIcon + 1) / 2;</span><br><span class="line"></span><br><span class="line">		// 绘制图标</span><br><span class="line">		dc.DrawIcon(x, y, m_hIcon);</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		CDialogEx::OnPaint();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//当用户拖动最小化窗口时系统调用此函数取得光标</span><br><span class="line">//显示。</span><br><span class="line">HCURSOR CDemoCVDlg::OnQueryDragIcon()</span><br><span class="line">&#123;</span><br><span class="line">	return static_cast&lt;HCURSOR&gt;(m_hIcon);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>![屏幕截图 2024-05-02 091700](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 091700.png)</p>
<p>![屏幕截图 2024-05-02 091711](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 091711.png)</p>
<p>![屏幕截图 2024-05-02 091719](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 091719.png)</p>
<p>![屏幕截图 2024-05-02 091733](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 091733.png)</p>
<p>![屏幕截图 2024-05-02 091748](.&#x2F;assets&#x2F;屏幕截图 2024-05-02 091748.png)</p>
<p>实例：<strong>MFC对话框控件和背景图片自适应窗口最大化和拉伸缩放的实现</strong></p>
<p>假设创建的对话框的类名是CMyDlg，具体过程如下： </p>
<p>步骤一：把easysize.h拷贝到CMyDlg项目文件夹中，同时在CMyDlg的.h文件和.cpp文件中加入#include”easysize.h”；</p>
<p>or（#include EasySize.h to your stdafx.h (or put it in your include directory and #include &lt;EasySize.h&gt; , which I recommend)</p>
<p>步骤二：在CMyDlg类的h文件中，加入DECLARE_EASYSIZE，注意结尾处不要加“；”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class CMyDlg : public CDialog</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">       DECLARE_EASYSIZE</span><br><span class="line"></span><br><span class="line">// Construction</span><br><span class="line"></span><br><span class="line">…</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>步骤三：在CMyDlg类的OnInitDialog()函数的结尾处加入INIT_EASYSIZE, 注意此处结尾处要加“；”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">BOOL CMyDlg::OnInitDialog()</span><br><span class="line"></span><br><span class="line">&#123;     …</span><br><span class="line"></span><br><span class="line">// TODO: Add extra initialization here</span><br><span class="line"></span><br><span class="line">​       INIT_EASYSIZE;</span><br><span class="line"></span><br><span class="line">​       return TRUE; // return TRUE unless you set the focus to a control</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>步骤四：增加WM_SIZE消息响应函数OnSize()，在函数中加入UPDATE_EASYSIZE，注意此处结尾处要加“；”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">void CMyDlg::OnSize(UINT nType, int cx, int cy)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">       CDialog::OnSize(nType, cx, cy);</span><br><span class="line"></span><br><span class="line">       // TODO: Add your message handler code here</span><br><span class="line"></span><br><span class="line">       UPDATE_EASYSIZE;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">OnSizing(）函数中可以设置窗口最小尺寸</span><br><span class="line"></span><br><span class="line">void CchinaDiankeSarDisPlayImagDlg::OnSizing(UINT fwSide, LPRECT pRect)</span><br><span class="line">&#123;</span><br><span class="line">CDialogEx::OnSizing(fwSide, pRect);</span><br><span class="line"></span><br><span class="line">// TODO: 在此处添加消息处理程序代码</span><br><span class="line">EASYSIZE_MINSIZE(587, 406, fwSide, pRect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    <p><img src="https://i.dawnlab.me/53a8c7cf3ad77a0f0a456ce2c6afe88a.png" loading="lazy"></p>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>Author：</strong>John Doe<br>
        <strong>Link：</strong><a href="http://example.com/2024/05/02/5.1/" title="http:&#x2F;&#x2F;example.com&#x2F;2024&#x2F;05&#x2F;02&#x2F;5.1&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;example.com&#x2F;2024&#x2F;05&#x2F;02&#x2F;5.1&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1720491932999"></script>
  

  
      <div class="nexmoe-post-footer">
          请在你的配置文件中设置 slotComment

      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            
            <button class="mdui-fab catalog" style="overflow:unset;">
                <i class="nexmoefont icon-i-catalog"></i>
                <div class="nexmoe-toc">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#GWCTF-2019-xxor"><span class="toc-number">1.</span> <span class="toc-text">[GWCTF 2019]xxor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#z3"><span class="toc-number">1.1.</span> <span class="toc-text">z3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-level3"><span class="toc-number">2.</span> <span class="toc-text">[WUSTCTF2020]level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84base64"><span class="toc-number">3.</span> <span class="toc-text">特殊的base64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Universe-final-answer"><span class="toc-number">4.</span> <span class="toc-text">Universe_final_answer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MFC"><span class="toc-number">5.</span> <span class="toc-text">MFC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">5.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E4%B8%8B%E4%BA%86%E8%A7%A3%E4%B8%8E%E7%BD%91%E7%BB%9C"><span class="toc-number">5.2.</span> <span class="toc-text">以下了解与网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">5.3.</span> <span class="toc-text">2</span></a></li></ol></li></ol>
                </div>
            </button>
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="Search" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div></body></html>